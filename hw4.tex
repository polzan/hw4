\documentclass[a4paper,oneside]{article}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[english]{babel}

\usepackage[margin=2.54cm]{geometry}
\usepackage{amsmath}
\usepackage{siunitx}
\usepackage{listings}
\usepackage{color}
\usepackage{textcomp}
\usepackage{graphicx}
%\usepackage{xr}
\usepackage{subcaption}
%\usepackage{changepage}
\usepackage[section]{placeins}
\usepackage{hyperref}

%\strictpagecheck
%\externaldocument{hw4_code}

\definecolor{matlabgreen}{RGB}{28,172,0}
\definecolor{matlablilas}{RGB}{170,55,241}

\newcommand{\includecode}[1]{\lstinputlisting[caption={\ttfamily #1.m},label={lst:#1}]{matlab/#1.m}}
\newcommand{\inlinecode}[1]{\lstinline[basicstyle=\ttfamily,keywordstyle={},stringstyle={},commentstyle={\itshape}]{#1}}

\renewcommand{\vec}[1]{\underline{#1}}
\renewcommand{\Re}[1]{\operatorname{Re}\left[#1\right]}
\renewcommand{\Im}[1]{\operatorname{Im}\left[#1\right]}
\newcommand{\E}[1]{\operatorname{E}\left[#1\right]}
\newcommand{\norm}[1]{\left\lVert#1\right\rVert}
\newcommand{\abs}[1]{\left|#1\right|}
\newcommand{\F}[1]{\operatorname{\mathcal{F}}\left[#1\right]}
\newcommand{\ceil}[1]{\left\lceil#1\right\rceil}
\newcommand{\floor}[1]{\left\lfloor#1\right\rfloor}
\newcommand{\Prob}[1]{\operatorname{P}\left[#1\right]}
\newcommand{\ProbC}[2]{\operatorname{P}\left[#1\middle|#2\right]}
\newcommand{\ind}[1]{\operatorname{\mathbbm{1}}\left\{#1\right\}}
\DeclareMathOperator*{\argmin}{argmin}
\DeclareMathOperator*{\argmax}{argmax}
\newcommand{\distr}[0]{\sim}
\newcommand{\unif}[1]{\mathcal{U}_{#1}}

\newcommand{\vsigma}[0]{\vec{\sigma}}

\newcolumntype{L}{>{$}l<{$}}
\newcolumntype{R}{>{$}r<{$}}
\newcolumntype{C}{>{$}c<{$}}

\author{Enrico Polo \and Riccardo Zanol}
\title{Homework 4}

\begin{document}
\lstset{
  language=Matlab,
  basicstyle={\ttfamily \footnotesize},
  breaklines=true,
  morekeywords={true,false,warning,xlim,ylim},
  keywordstyle=\color{blue},
  stringstyle=\color{matlablilas},
  commentstyle={\color{matlabgreen} \itshape},
  numberstyle={\ttfamily \tiny},
  frame=leftline,
  showstringspaces=false,
  numbers=left,
  upquote=true,
}
\maketitle
\section{Bit error probability comparison}
\begin{figure}[htbp]
  \centering
  \includegraphics[width=\textwidth]{matlab/pbits_uncoded}
  \caption{$P_{bit}$ comparison while transmitting uncoded bits}
  \label{plot:uncoded}
\end{figure}
In Fig.~\ref{plot:uncoded} we report the bit error probabilities that
we obtain by simulating the single carrier (section~\ref{sec:dfe}) and
the OFDM (section~\ref{sec:ofdm}) systems for various values of the
SNR. Together with these two systems we plot the same bound
simulated in HW3 that we obtain with an AWGN channel:
\begin{align}
  y_k &= a_k + w_k \\
  w_k & \distr \mathcal{CN}(0, \sigma^2_w) \\
  \sigma^2_w &= \frac{\sigma^2_a}{\Gamma} \\
  \sigma^2_a &= 2 .
\end{align}

For each point of the plot we generate 3 millions of uniformly
distributed bits and map them into symbols from the same constellation
of HW3, associating the even bits to the real part and the odd bits
to the imaginary part
\begin{align}
  \mathcal{A} &= \left\{ 1+j, -1+j, -1-j, 1-j \right\} \\
  b_{2l}  & \leftrightarrow \Re{a_k} \\
  b_{2l+1}  & \leftrightarrow \Im{a_k}
\end{align}
and then we simulate the transmission of these symbols through the
AWGN, OFDM and DFE systems. The received signals $y_k$ are then passed
to a threshold detector to obtain the bits.

\begin{figure}[htbp]
  \centering
  \includegraphics[width=\textwidth]{matlab/pbits_coded}
  \caption{$P_{bit}$ comparison while transmitting LDPC-coded bits}
  \label{plot:coded}
\end{figure}
In Fig.~\ref{plot:coded} there are the bit error probabilities of the
same three systems when the input bits are channel-coded before being
mapped to symbols.

In this case we also generate 3 millions (rounded up to a multiple of
the LDPC block size) of uniformly distributed bits for each point of
the plot, but they are coded by an LDPC encoder, that uses the default
settings of Matlab, and then reordered by an interleaver that writes
the input bits by columns in a $31\times35$ matrix and reads them by
row. The resulting bits $c'_p$ are then mapped into symbols like in
the uncoded case and sent through each one of the three systems.  This
time, instead of using a threshold detector, we compute the
log-likelihood ratio of the received bits from the real and imaginary
parts of $y_k$
\begin{align}
  l'_{2k} &= \frac{2\Re{y_k}}{\sigma^2_w/2} \\
    l'_{2k+1} &= \frac{2\Im{y_k}}{\sigma^2_w/2}
\end{align}
with a noise power $\sigma^2_w$ that depends on which system we are
simulating. The LLR $l'_p$ is then deinterlaced by writing its samples
by row in a $31\times35$ matrix and reading them by column and it is
then passed to the LDPC decoder that outputs the detected bits
$\hat{b}_l$.
\section{DFE}


\section{DFE}
The configuaration of the SC scheme is the same of the point b) of the previous homework as required. The parameter we used were:
\begin{itemize}
\item M1 = 3;
\item  M2 = 2;
\item D = 1.
\end{itemize}
M1 is the length of the equalizer filter $c$, M2 is the length of the feedback filter $b$ and $D$ is ????????????????????the delay introduced before the $c$ filter??????????????????????.
As suggested, we cutted a little bit more the channel impulse response, whose behaviour is shown in Fig. ~\ref{plot:qc}. So we have also to adapt the optimal value of $\Bar{t_0}$ that now is $\Bar{t_0} = 19$ (number of samples $T_c$), in order to sample in the peak of the overall impulse response before the sampler.
\section{OFDM}

\begin{figure}[htbp]
  \centering
  \includegraphics[width=0.6\textwidth]{matlab/qc}
  \caption{Channel impulse response}
  \label{plot:qc}
\end{figure}

\begin{figure}[htbp]
  \centering
  \includegraphics[width=0.6\textwidth]{matlab/g_rcos}
  \caption{Trasmitter/receiver filter impulse response}
  \label{plot:g_rcos}
\end{figure}

\begin{figure}[htbp]
  \centering
  \includegraphics[width=0.6\textwidth]{matlab/gc}
  \caption{Global impulse response before receiver sampler}
  \label{plot:gc}
\end{figure}

\begin{figure}[htbp]
  \centering
  \includegraphics[width=0.6\textwidth]{matlab/h}
  \caption{Equivalent channel impulse response}
  \label{plot:h}
\end{figure}


\begin{figure}[htbp]
  \centering
  \includegraphics[width=0.6\textwidth]{matlab/qc_freqz}
  \caption{Channel frequency response}
  \label{plot:qc_freqz}
\end{figure}

\begin{figure}[htbp]
  \centering
  \includegraphics[width=0.6\textwidth]{matlab/g_rcos_freqz}
  \caption{Trasmitter/receiver filter frequency response}
  \label{plot:g_rcos_freqz}
\end{figure}

\begin{figure}[htbp]
  \centering
  \includegraphics[width=0.6\textwidth]{matlab/gc_dft}
  \caption{Global frequency response before receiver sampler}
  \label{plot:gc_dft}
\end{figure}


\end{document}
